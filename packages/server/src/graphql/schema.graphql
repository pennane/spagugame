scalar Date

enum GameType {
  TICK_TACK_TOE
}

enum UserRole {
  USER
  ADMIN
}

# Static mongo types

## User

type User {
  _id: ID!
  githubID: ID!
  userName: String!
  description: String
  roles: [UserRole!]!
  joinedAt: Date!
}

input UserInput {
  userName: String
  description: String
}

## UserStats

type UserStats {
  _id: ID!
  userId: ID!
  gameID: ID!
  totalWins: Int!
  totalLosses: Int!
  totalDraws: Int!
  elo: Int!
}

## Game

type Game {
  _id: ID!
  type: GameType!
  name: String!
  description: String!
}

## PlayedGame

type PlayedGame {
  _id: ID!
  gameId: ID!
  playerIdsInWinningOrder: [ID!]!
  playerElosBeforeInWinningOrder: [Int!]!
  playerElosAfterInWinningOrder: [Int!]!
  startedAt: Date!
  finishedAt: Date!
}

# Ongoing game types

type OngoingGamePlayer {
  userId: ID!
  score: Int!
}

enum OngoingGameProcessState {
  NOT_STARTED
  STARTING
  ONGOING
  FINISHED
  CANCELLED
}

type OngoingGame {
  _id: ID!
  gameType: GameType!
  processState: OngoingGameProcessState!
  jsonState: String!
  players: [OngoingGamePlayer!]!
  currentTurn: ID
}

type OngoingGameStateChange {
  _id: ID
  gameType: GameType
  processState: OngoingGameProcessState
  jsonState: String
  players: [OngoingGamePlayer!]
  currentTurn: ID
  startsIn: Int
}

type Query {
  ongoingGame(ongoingGameId: ID!): OngoingGame!
  userActiveGames(userId: ID!): [OngoingGame!]!
  user(id: ID!): User
  users(ids: [ID!]!): [User!]!
  currentUser: User
  game(id: ID!): Game
  games(ids: [ID!]): [Game!]!
}

type Subscription {
  ongoingGameStateChange(ongoingGameId: ID!): OngoingGameStateChange!
}

type Mutation {
  createOngoingGame(gameType: GameType!): OngoingGame!
  joinOngoingGame(ongoingGameId: ID!): OngoingGame!
  playTurn(ongoingGameId: ID!, json: String!): OngoingGame!
  updateUser(userInput: UserInput): User!
}
